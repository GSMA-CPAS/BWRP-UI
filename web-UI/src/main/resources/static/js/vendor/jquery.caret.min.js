/*
 Copyright (C) Shawn Miles 2015
 Distributed under the MIT License (license terms are at http://opensource.org/licenses/MIT).
 */
!function(e){function l(e){document.activeElement&&document.activeElement===e||e.focus()}jQuery.fn.caret=function(e){var t=this[0],n="true"===t.contentEditable;if(0==arguments.length){if(window.getSelection){if(n){l(t);var o=window.getSelection();return o.rangeCount?((r=(c=o.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(c.endContainer,c.endOffset),r.toString().length):0}return t.selectionStart}if(document.selection){if(l(t),n){var c=document.selection.createRange();return(r=document.body.createTextRange()).moveToElementText(t),r.setEndPoint("EndToEnd",c),r.text.length}e=0;var r,a=t.createTextRange(),i=(r=document.selection.createRange().duplicate()).getBookmark();for(a.moveToBookmark(i);0!==a.moveStart("character",-1);)e++;return e}return 0}if(-1==e&&(e=this[n?"text":"val"]().length),window.getSelection)n?(l(t),window.getSelection().collapse(t.firstChild,e)):t.setSelectionRange(e,e);else if(document.body.createTextRange){(a=document.body.createTextRange()).moveToElementText(t),a.moveStart("character",e),a.collapse(!0),a.select()}return n||l(t),e}}();